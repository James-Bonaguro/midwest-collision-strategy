<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collision Repair Industry Shift</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

        :root {
            --color-claims: #1FB8CD;
            --color-loss: #DB4545;
            --color-tech: #2E8B57;
            --color-dark: #111827;
            --color-gray: #6B7280;
            --color-light: #F3F4F6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #e5e7eb;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        /* Print Container - Fixed Aspect Ratio (Letter) */
        .page-container {
            width: 8.5in;
            height: 11in;
            background: white;
            position: relative;
            display: flex;
            flex-direction: column;
            padding: 0.75in;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* Top Section: Title */
        header {
            height: 15%;
            border-bottom: 4px solid var(--color-dark);
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        h1 {
            font-size: 32pt;
            font-weight: 800;
            color: var(--color-dark);
            line-height: 1.1;
            text-transform: uppercase;
            letter-spacing: -0.02em;
        }

        h2 {
            font-size: 18pt;
            font-weight: 600;
            color: var(--color-loss);
            margin-top: 10px;
        }

        /* Middle Section: Chart */
        .chart-section {
            height: 50%;
            position: relative;
            width: 100%;
            margin-bottom: 30px;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
            font-size: 10pt;
            font-weight: 600;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Bottom Section: Callouts */
        .stats-grid {
            height: 30%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 20px;
        }

        .stat-card {
            background-color: var(--color-light);
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-left: 8px solid var(--color-dark);
            position: relative;
        }

        .stat-card:nth-child(1) { border-color: var(--color-claims); }
        .stat-card:nth-child(2) { border-color: var(--color-loss); }
        .stat-card:nth-child(3) { border-color: var(--color-gray); }
        .stat-card:nth-child(4) { border-color: var(--color-tech); }

        .stat-value {
            font-size: 24pt;
            font-weight: 800;
            color: var(--color-dark);
            line-height: 1.1;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 11pt;
            font-weight: 600;
            color: var(--color-gray);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .icon-box {
            position: absolute;
            top: 20px;
            right: 20px;
            opacity: 0.15;
            color: var(--color-dark);
        }

        /* Footer */
        footer {
            height: 5%;
            display: flex;
            align-items: flex-end;
            justify-content: flex-end;
            font-size: 10pt;
            color: var(--color-gray);
            border-top: 1px solid #e5e7eb;
            margin-top: auto;
            padding-top: 10px;
        }

        /* Print Override */
        @media print {
            body {
                background: none;
                padding: 0;
            }
            .page-container {
                width: 100%;
                height: 100vh;
                box-shadow: none;
                padding: 0.5in; /* Slightly smaller margin for safe printing */
            }
        }
    </style>
</head>
<body>

    <div class="page-container">
        <!-- Header -->
        <header>
            <h1>Capacity Crisis &rarr; Solvency Crisis</h1>
            <h2>What Changed: The Structural Shift (2022-2025)</h2>
        </header>

        <!-- Chart Section -->
        <div class="chart-section">
            <div class="chart-legend">
                <div class="legend-item"><span class="dot" style="background:var(--color-claims)"></span>Claims Index (Left)</div>
                <div class="legend-item"><span class="dot" style="background:var(--color-loss)"></span>Total Loss % (Right)</div>
                <div class="legend-item"><span class="dot" style="background:var(--color-tech)"></span>Tech Openings (Right)</div>
            </div>
            <canvas id="mainChart"></canvas>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <!-- Stat 1 -->
            <div class="stat-card">
                <div class="icon-box"><i data-lucide="trending-down" size="48"></i></div>
                <div class="stat-value">Claims Down 10%</div>
                <div class="stat-label">Demand Shock</div>
            </div>

            <!-- Stat 2 -->
            <div class="stat-card">
                <div class="icon-box"><i data-lucide="percent" size="48"></i></div>
                <div class="stat-value">Parts +19%<br>Reimb. +8%</div>
                <div class="stat-label">Margin Compression</div>
            </div>

            <!-- Stat 3 -->
            <div class="stat-card">
                <div class="icon-box"><i data-lucide="users" size="48"></i></div>
                <div class="stat-value">49% Owners 60+</div>
                <div class="stat-label">Succession Risk</div>
            </div>

            <!-- Stat 4 -->
            <div class="stat-card">
                <div class="icon-box"><i data-lucide="store" size="48"></i></div>
                <div class="stat-value">Acquisitions<br>Down 35%</div>
                <div class="stat-label">Consolidation Stalled</div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            getclearbrief@gmail.com
        </footer>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Icons safely
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            // Data
            const quarters = ["Q4 '21", "Q2 '22", "Q4 '22", "Q2 '23", "Q4 '23", "Q2 '24", "Q4 '24", "Q2 '25"];
            const claimsIndex = [100, 102, 101, 101.5, 100, 97, 95, 90];
            const totalLoss = [20.5, 21.0, 21.5, 21.8, 22.0, 22.1, 22.5, 22.8];
            const techOpenings = [164, 156, 150, 140, 130, 95, 85, 79];

            // Chart Configuration
            const ctx = document.getElementById('mainChart').getContext('2d');
            const mainChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: quarters,
                    datasets: [
                        {
                            label: 'Claims Index',
                            data: claimsIndex,
                            borderColor: '#1FB8CD', // Teal
                            backgroundColor: '#1FB8CD',
                            borderWidth: 4,
                            yAxisID: 'y',
                            tension: 0.3,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Total Loss %',
                            data: totalLoss,
                            borderColor: '#DB4545', // Red
                            backgroundColor: '#DB4545',
                            borderWidth: 4,
                            borderDash: [5, 5],
                            yAxisID: 'y1',
                            tension: 0.3,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Tech Openings',
                            data: techOpenings,
                            borderColor: '#2E8B57', // Green
                            backgroundColor: '#2E8B57',
                            borderWidth: 4,
                            yAxisID: 'y1', // Sharing right axis per request logic
                            tension: 0.3,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false, // Turn off animation for immediate print readiness
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    family: 'Inter',
                                    weight: '600'
                                },
                                color: '#374151'
                            }
                        },
                        y: { // Left Axis - Claims
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Claims Volume Index',
                                color: '#1FB8CD',
                                font: { weight: 'bold' }
                            },
                            min: 85,
                            max: 105,
                            grid: {
                                color: '#E5E7EB'
                            }
                        },
                        y1: { // Right Axis - Shared
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Total Loss % / Tech Openings',
                                color: '#374151',
                                font: { weight: 'bold' }
                            },
                            min: 15,
                            max: 170, // Range to accommodate both datasets
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // Using custom legend
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>
